import{d as S,g as c,a as k,m as u,e as o,v as l,G as s,M as z,u as K,y as b,z as L,O as M,C as d}from"./index-wlcSVvoI.js";import{g as N}from"./dataset-DBM0yH9-.js";const P={class:"dataset-container"},V={key:0,class:"debug-info"},G=S({__name:"index",setup(A){const p=M(),i=c(!0),a=c([]),n=c({current:1,pageSize:10,total:0}),_=e=>e?new Date(e*1e3).toLocaleString():"",g=[{colKey:"index",title:"序号",width:"80",cell:(e,{rowIndex:t})=>(n.value.current-1)*n.value.pageSize+t+1},{colKey:"name",title:"知识库名称"},{colKey:"description",title:"描述",cell:(e,{row:t})=>(t==null?void 0:t.description)||"暂无描述"},{colKey:"document_count",title:"文档数量"},{colKey:"created_at",title:"创建时间",cell:(e,{row:t})=>_(t==null?void 0:t.created_at)},{colKey:"operation",title:"操作",width:"160",fixed:"right",cell:"operationCol"}],r=async()=>{i.value=!0;try{const e=await N({page:n.value.current,limit:n.value.pageSize});Array.isArray(e.data)?a.value=e.data:e.data?a.value=[e.data]:a.value=[],n.value.total=e.total||0,console.log("获取到知识库列表:",a.value)}catch(e){console.error("获取知识库列表失败:",e),z.error("获取知识库列表失败"),a.value=[]}finally{i.value=!1}},v=e=>{p.push(`/app/dataset/detail/${e.id}`)},m=e=>{n.value.current=e.current,n.value.pageSize=e.pageSize,r()};return k(()=>{r()}),(e,t)=>{const f=s("t-button"),h=s("t-space"),y=s("t-table"),C=s("t-loading"),x=s("t-card");return d(),u("div",P,[o(x,{title:"知识库管理",class:"dataset-card"},{default:l(()=>[o(C,{loading:i.value},{default:l(()=>[a.value.length>0?(d(),u("div",V," 已加载 "+b(a.value.length)+" 条记录 ",1)):K("",!0),o(y,{data:a.value,columns:g,pagination:n.value,"row-key":"id",stripe:"",hover:"",onPageChange:m,empty:"暂无数据"},{operationCol:l(({row:D})=>[o(h,null,{default:l(()=>[o(f,{theme:"primary",variant:"text",onClick:B=>v(D)},{default:l(()=>t[0]||(t[0]=[L("查看")])),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data","pagination"])]),_:1},8,["loading"])]),_:1})])}}});export{G as default};
